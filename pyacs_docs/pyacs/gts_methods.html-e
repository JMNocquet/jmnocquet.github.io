

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Gts methods &mdash; pyacs 0.65.3 documentation</title>
  

  
  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/doctools.js"></script>
        <script src="static/language_data.js"></script>
    
    <script type="text/javascript" src="static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyacs
          

          
          </a>

          
            
            
              <div class="version">
                0.65.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="foreword.html">What is pyacs?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">How to install pyacs?</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">pyacs core libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="gts.html">Time series library</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_time_series.html">pyacs_make_time_series.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_series.html">Time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Full code documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyacs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Gts methods</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/gts_methods.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gts-methods">
<h1>Gts methods<a class="headerlink" href="#gts-methods" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#gts-format-methods"><span class="std std-ref">Gts format methods</span></a></p></li>
<li><p><a class="reference internal" href="#gts-primitive-methods"><span class="std std-ref">Gts primitive methods</span></a></p></li>
<li><p><a class="reference internal" href="#gts-model-methods"><span class="std std-ref">Gts model methods</span></a></p></li>
<li><p><a class="reference internal" href="#gts-filter-methods"><span class="std std-ref">Gts filter methods</span></a></p></li>
<li><p><a class="reference internal" href="#gts-outliers-methods"><span class="std std-ref">Gts outliers methods</span></a></p></li>
<li><p><a class="reference internal" href="#gts-plot-methods"><span class="std std-ref">Gts plot methods</span></a></p></li>
</ul>
<div class="section" id="gts-format-methods">
<h2>Gts format methods<a class="headerlink" href="#gts-format-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyacs.gts.Gts.Gts">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyacs.gts.Gts.Gts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pos">
<code class="sig-name descname">read_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Read GAMIT/GLOBK PBO pos file in a directory and actually loads the time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsdir</strong> – directory of pos file</p></li>
<li><p><strong>tsfile</strong> – pos file to be loaded</p></li>
<li><p><strong>xyz</strong> – reads xyz sx sy sz corr_xy corr_xz corr_yz columns</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Since a pos file includes (almost) all the information, data, code, X0,Y0,Z0,t0 will be populated</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>If tsfile=None, then read_pos will look for a file named CODE*.pos</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.write_pos">
<code class="sig-name descname">write_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span></em>, <em class="sig-param"><span class="n">add_key</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">force</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.write_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a time series in GAMIT/GLOBK PBO pos format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idir</strong> – output directory</p></li>
<li><p><strong>add_key</strong> – if not blank then the output pos file will be CODE_add_key.pos, CODE.pos otherwise.</p></li>
<li><p><strong>force</strong> – set force to ‘data’ or ‘data_xyz’ to force pos to be written from .data or .data_xyz</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>:note1:default behaviour (force = None)</dt><dd><p>if data and data_xyz are not None, then print them independently
if there are data only, then uses X0,Y0,Z0 to write data_xyz
if there are data_xyz only, recreate data and write it</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_cats_file">
<code class="sig-name descname">read_cats_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_cats_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read cats files in a directory and actually loads the time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.write_cats">
<code class="sig-name descname">write_cats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_key</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.write_cats" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a file for a cats analysis
if offsets_dates is not None then offsets are added at the beginning of the file</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.force_daily">
<code class="sig-name descname">force_daily</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.force_daily" title="Permalink to this definition">¶</a></dt>
<dd><p>force a time series to be daily with dates at 12:00:00 of every day</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.get_unr">
<code class="sig-name descname">get_unr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">site</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.get_unr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a time series from <a class="reference external" href="http://geodesy.unr.edu/gps_timeseries/txyz/IGS14/">http://geodesy.unr.edu/gps_timeseries/txyz/IGS14/</a> in PYACS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site</strong> – 4-letters code</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_kenv">
<code class="sig-name descname">read_kenv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ifile</span></em>, <em class="sig-param"><span class="n">date_type</span><span class="o">=</span><span class="default_value">'jd'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_kenv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read kenv file (magnet) format for time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_mb_file">
<code class="sig-name descname">read_mb_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_mb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read GAMIT/GLOBK mb_files in a directory and actually loads the time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pride">
<code class="sig-name descname">read_pride</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pride" title="Permalink to this definition">¶</a></dt>
<dd><p>Read PRIDE-PPPAR kinematic result file
:param tsdir: directory of pride-pppar kinematic files
:param tsfile: pride-pppar kinematic file to be loaded
:param verbose: verbose mode
:return Nothing:
:note: If file=None, then read_pride will look for a files named kin_*code</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_pride_pos">
<code class="sig-name descname">read_pride_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_pride_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Read PRIDE-PPPAR static result file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsdir</strong> – directory of pride-pppar pos static files</p></li>
<li><p><strong>tsfile</strong> – pride-pppar pos static file to be loaded</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:note:If file=None, then read_pride will look for a files named pos_*code</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_tdp">
<code class="sig-name descname">read_tdp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gmt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_tdp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tdp (Gipsy kinematics provided by Cedric Twardzik 17/04/2018) format for time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.to_pandas_df">
<code class="sig-name descname">to_pandas_df</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.to_pandas_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a pyacs Gts to a pandas dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>uncertainties are not imported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.read_track_NEU">
<code class="sig-name descname">read_track_NEU</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsdir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">tsfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leap_sec</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">eq_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.read_track_NEU" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a GAMIT/GLOBK Track output file generated with the option out_type NEU
in this case dates are seconds
by default the seconds are with respect to the first epoch of measurements
If option leap_sec is provided with a value &gt; 0.0, then GPS time is corrected for the difference between GPTS time and UTC 
If eq_time is provided, it is assumed to be UTC. Expected format is YYYY:MM:MD:HH:MM:SS.S</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gts-primitive-methods">
<h2>Gts primitive methods<a class="headerlink" href="#gts-primitive-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id0">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.cdata">
<code class="sig-name descname">cdata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.cdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Check data/data_xyz attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – boolean, if True, data attribute will be checked</p></li>
<li><p><strong>data_xyz</strong> – boolean, if True, data_xyz attribute will be checked</p></li>
<li><p><strong>tol</strong> – tolerance in days for two dates to be considered as the same (default 0.001 of day)</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : boolean, True if everything is OK, False otherwise</p>
<p>:note : in future, this routine should also whether .data and .data_xyz value are consistent</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">loutliers</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>makes a (deep) copy of the time series.</p>
<p>By default, all attributes are also copied, including .data, .data_xyz, loutliers etc.</p>
<p>Default behaviour can be modified for the following attribute:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – can be set to None or a 2D numpy array of shape (n,10)</p></li>
<li><p><strong>data_xyz</strong> – can be set to None or a 2D numpy array of shape (n,10)</p></li>
<li><p><strong>loutliers</strong> – False will not copy the loutliers atrribute</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.differentiate">
<code class="sig-name descname">differentiate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.differentiate" title="Permalink to this definition">¶</a></dt>
<dd><p>differentiate the current time series
:return: the differentiated time series as a new Gts object
:note : differentiation is made on .data. .data_xyz is set to None.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_periods">
<code class="sig-name descname">extract_periods</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lperiod</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">no_reset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_periods" title="Permalink to this definition">¶</a></dt>
<dd><p>extract periods of a Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lperiod</strong> – a list [start_date,end_date] or a list of periods e.g. periods=[[2000.1,2003.5],[2009.3,2010.8]]</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
</ul>
</dd>
<dt class="field-even">Note 1</dt>
<dd class="field-even"><p>X0,Y0,Z0 attributes will be changed if necessary</p>
</dd>
<dt class="field-odd">Note 2</dt>
<dd class="field-odd"><p>handles both .data and .data_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.exclude_periods">
<code class="sig-name descname">exclude_periods</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lperiod</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.exclude_periods" title="Permalink to this definition">¶</a></dt>
<dd><p>exclude periods of a Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lperiod</strong> – a list [start_date,end_date] or a list of periods e.g. periods=[[2000.1,2003.5],[2009.3,2010.8]]</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
</ul>
</dd>
<dt class="field-even">Note 1</dt>
<dd class="field-even"><p>X0,Y0,Z0 attributes will be changed if necessary</p>
</dd>
<dt class="field-odd">Note 2</dt>
<dd class="field-odd"><p>handles both .data and .data_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_dates">
<code class="sig-name descname">extract_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dates</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a time series extracted for a given list of dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> – dates either as a list or  1D numpy array of decimal dates</p></li>
<li><p><strong>tol</strong> – date tolerance in days to assert that two dates are equal (default 0.05 day)</p></li>
<li><p><strong>in_place</strong> – if True, will make change in place, if False, return s a new time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.substract_ts">
<code class="sig-name descname">substract_ts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.substract_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>substract the ts provided as argument to the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – time series to be substracted as a Gts instance</p></li>
<li><p><strong>tol</strong> – date tolerance to decide whether two dates are identical in both time series. default = 1/4 day</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.substract_ts_daily">
<code class="sig-name descname">substract_ts_daily</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.substract_ts_daily" title="Permalink to this definition">¶</a></dt>
<dd><p>substract the ts provided as argument to the current time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – time series to be substracted as a Gts instance</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>this method assumes daily time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_offsets_dates">
<code class="sig-name descname">add_offsets_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offsets_dates</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_offsets_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>add_offsets_dates to a time series
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_velocity">
<code class="sig-name descname">remove_velocity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vel_neu</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>remove velocity from a time series
vel_neu is a 1D array of any arbitrary length, but with the velocities (NEU) to be removed in the first 3 columns
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.set_zero_at_date">
<code class="sig-name descname">set_zero_at_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.set_zero_at_date" title="Permalink to this definition">¶</a></dt>
<dd><p>make a translation of a time series, setting to 0 at a given date
if the provided date does not exist, uses the next date available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>offset</strong> – an offset (in mm) to be added. Could be a float, a list or 1D numpy array with 3 elements</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.decimate">
<code class="sig-name descname">decimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_step</span><span class="o">=</span><span class="default_value">30.0</span></em>, <em class="sig-param"><span class="n">dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>decimate a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_step</strong> – time step in days</p></li>
<li><p><strong>dates</strong> – list of dates where point are forced to be written regardless time_step</p></li>
<li><p><strong>method</strong> – method used to be used to calculated the position. choose among [‘median’,’mean’,’exact’]</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.displacement">
<code class="sig-name descname">displacement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sdate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">speriod</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">eperiod</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">rounding</span><span class="o">=</span><span class="default_value">'day'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates displacements between two dates or two periods</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – start date in decimal year</p></li>
<li><p><strong>edate</strong> – start date in decimal year</p></li>
<li><p><strong>window</strong> – time window in days for searching available dates</p></li>
<li><p><strong>method</strong> – method to calculate the position. ‘median’ or ‘mean’. default is ‘median’.</p></li>
<li><p><strong>speriod</strong> – period for calculating the start position</p></li>
<li><p><strong>eperiod</strong> – period for calculating the end position</p></li>
<li><p><strong>rounding</strong> – rounding for dates. Choose among ‘day’,’hour’,’minute’ or ‘second’. default is ‘day’.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>displacement as np.array([dn,de,du,sdn,sde,sdu])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_obs">
<code class="sig-name descname">add_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">NEUSNSESUCNECNUCEU</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">check</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds observation(s) as DN,DE,DU to a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year. float, a list or 1D numpy array</p></li>
<li><p><strong>NEUSNSESUCNECNUCEU</strong> – value to be added in the Gts, provided as a list, a 1D numpy array or a 2D numpy array.
requires at least NEU: North, East, UP values
optional: SN, SE, SU, CNE, CNU, CEU: standard deviations and correlation coefficient between North, East and Up components.
If not provided, SN=SE=SU=0.001 (1 mm) and CNE=CNU=CEU=0</p></li>
<li><p><strong>in_place</strong> – boolean, if True add_obs to the current Gts, if False, returns a new Gts</p></li>
<li><p><strong>check</strong> – check time order and duplicate dates</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new Gts or the modified Gts if in_place</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>if it exists, .data_xyz will be set to None for consistency.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_obs_xyz">
<code class="sig-name descname">add_obs_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">XYZSXSYSZCXYCXZCYZ</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">check</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">neu</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_obs_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds observation(s) as XYZ to a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year. float, a list or 1D numpy array</p></li>
<li><p><strong>XYZSXSYSZCXYCXZCYZ</strong> – value to be added in the Gts, provided as a list, a 1D numpy array or a 2D numpy array.    requires at least X,Y,Z. Optional: SX, SY, SZ, CXY, CXZ, CYZ: standard deviations and correlation coefficients.    If not provided, SX=SY=SZ=0.001 (1 mm) and CXY=CXZ=CYZ=0</p></li>
<li><p><strong>in_place</strong> – boolean, if True add_obs to the current Gts, if False, returns a new Gts</p></li>
<li><p><strong>check</strong> – check time order , duplicate dates and re-generate NEU time series (.data)</p></li>
<li><p><strong>neu</strong> – regenerate .data from the updated .data_xyz</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts or the modified Gts if in_place
:note 1: by default .data will be updated from .data_xyz, and X0,Y0,Z0 will be updated.
:note 2:</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.xyz2neu">
<code class="sig-name descname">xyz2neu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">corr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ref_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.xyz2neu" title="Permalink to this definition">¶</a></dt>
<dd><p>populates neu (data) using xyz (data_xyz)
lon, lat and h will also be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr</strong> – if True, then standard deviation and correlations will also be calculated</p></li>
<li><p><strong>ref_xyz</strong> – [X,Y,Z] corresponding to the 0 of the local NEU frame. If not provided, the first position is used as a reference</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>this method is always in place</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.neu2xyz">
<code class="sig-name descname">neu2xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">corr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.neu2xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>populates .data_xyz from .data
requires X0,Y0,Z0 attributes to be set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr</strong> – if True, then standard deviation and correlations will also be calculated</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.reorder">
<code class="sig-name descname">reorder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>reorder data and/or data_xyz by increasing dates
always in place</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – verbose mode</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_before_date">
<code class="sig-name descname">extract_ndates_before_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_before_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values before a given date
If n values are not available, returns all available values before date
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_after_date">
<code class="sig-name descname">extract_ndates_after_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_after_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values after a given date
If n values are not available, returns all available values after date
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.extract_ndates_around_date">
<code class="sig-name descname">extract_ndates_around_date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.extract_ndates_around_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract n values before and n values after a given date
If n values are not available, returns all available values
.data is set to None if no value at all is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – date in decimal year</p></li>
<li><p><strong>n</strong> – number of observations to be extracted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Gts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.get_coseismic">
<code class="sig-name descname">get_coseismic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_date</span></em>, <em class="sig-param"><span class="n">window_days</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sample_after</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.get_coseismic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get coseismic displacement at a given date.
Coseismic displacement is estimated as the position difference between the median of window_days before 
the earthquake date and the median of sample_after samples after the earthquake date.</p>
<p>note: only median method implemented</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.correct_duplicated_dates">
<code class="sig-name descname">correct_duplicated_dates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">action</span><span class="o">=</span><span class="default_value">'correct'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.correct_duplicated_dates" title="Permalink to this definition">¶</a></dt>
<dd><p>Check or remove duplicated dates in a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> – ‘correct’ (default) or ‘check’</p></li>
<li><p><strong>tol</strong> – tolerance for two dates to be considered as the same (default = 0.1 day)</p></li>
<li><p><strong>in_place</strong> – boolean, if True,</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">angle</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>rotates the axis by an angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angle</strong> – angle in decimal degrees clockwise</p>
</dd>
</dl>
<p>if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.insert_gts_data">
<code class="sig-name descname">insert_gts_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gts</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.insert_gts_data" title="Permalink to this definition">¶</a></dt>
<dd><p>insert data (and/or) .data_xyz of a gts into the current gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gts</strong> – time series to be inserted</p></li>
<li><p><strong>in_place</strong> – boolean, if True add_obs to the current Gts, if False, returns a new Gts</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
</dl>
<p>:return : new Gts or the modified Gts if in_place</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.insert_ts">
<code class="sig-name descname">insert_ts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">rounding</span><span class="o">=</span><span class="default_value">'day'</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">'xyz'</span></em>, <em class="sig-param"><span class="n">overlap</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.insert_ts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – Gts to be inserted</p></li>
<li><p><strong>rounding</strong> – data rounding, used to decide whether an entry should be replaced.
Choose among [‘second’,’minute’,’hour’,’day]</p></li>
<li><p><strong>data</strong> – Gts attribute to be updated. ‘xyz’ for .data_xyz or None for .data</p></li>
<li><p><strong>overlap</strong> – if True, update occurs only on dates. If False, then ts overwrites the current Gts over the ts period</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new gts</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>The returned gts will have .data or .data_xyz will be set to None according to data argument</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_large_uncertainty">
<code class="sig-name descname">find_large_uncertainty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma_thresold</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">'NE'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_large_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find dates with large uncertainty and flag them as outliers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_threshold</strong> – value (mm) for a date to be flagged.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
<li><p><strong>lcomponent</strong> – list of components to be checked. default = ‘NE’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.split_gap">
<code class="sig-name descname">split_gap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gap</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.split_gap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gap</strong> – gap in number of days to split the time series</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list a gts split from the original</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span><span class="o">=</span><span class="default_value">'day'</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'linear'</span></em>, <em class="sig-param"><span class="n">gap</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – Gts instance</p></li>
<li><p><strong>date</strong> – ‘day’ will perform daily interpolation, alternatively date is a 1D numpy array with either datetime or decimal year</p></li>
<li><p><strong>method</strong> – scipy.interpolate.interp1d kind argument</p></li>
<li><p><strong>gap</strong> – maximum gap for interpolation</p></li>
<li><p><strong>in_place</strong> – boolean.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gts-model-methods">
<h2>Gts model methods<a class="headerlink" href="#gts-model-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id1">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend">
<code class="sig-name descname">detrend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend" title="Permalink to this definition">¶</a></dt>
<dd><p>detrends a time series and save velocity estimates in velocity attribute</p>
<p>:param periods         : periods used to estimate the velocity
:param exclude_periods : periods to be excluded for the velocity estimate
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are omitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_seasonal">
<code class="sig-name descname">detrend_seasonal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_seasonal" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates a trend + annual + semi-annual terms in a time series and removes them
velocity, annual and semi-annual attributes are saved in Gts.velocity, Gts.annual, Gts.semi_annual</p>
<p>:param periods         : periods used for estimation
:param exclude_periods : periods to be excluded from estimation
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are ommitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_annual">
<code class="sig-name descname">detrend_annual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_annual" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates a trend + annual terms in a time series and removes them
velocity and annual attribute are saved in Gts.velocity &amp; Gts.annual</p>
<p>:param periods         : periods used for estimation
:param exclude_periods : periods to be excluded from estimation
:param in_place        : if True then replace the current time series
:return                : the detrended time series
:note                  : outliers from Gts.outliers are ommitted in the estimation and
offsets given Gts.offsets_dates are estimated simultaneously</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_median">
<code class="sig-name descname">detrend_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta_day</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">exclude_periods</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">auto</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a velocity using the median of pair of displacements exactly separated by one year, inspired from MIDAS
If the time series has less than a year of data, then the time series is kept untouched.
:param delta_day: if None, it is one year, if 0 then it is the relax mode for campaign data,</p>
<blockquote>
<div><p>any integer is the time delta (in days) used to compute velocity.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_place</strong> – boolean, if True, in_place, if False, returns a new Gts instance (default)</p></li>
<li><p><strong>periods</strong> – periods (list of lists) to be included for trend calculation</p></li>
<li><p><strong>exclude_periods</strong> – periods (list of lists) to be excluded for trend calculation</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
<li><p><strong>auto</strong> – if True, then start will delta_day=None, if it fails or found less than 100 pairs then use delta_day=0,
if fails then use regular detrend</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>returns None if time series is shorter than 1 year</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.detrend_seasonal_median">
<code class="sig-name descname">detrend_seasonal_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wl</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.detrend_seasonal_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a velocity using the median of pair of displacements exactly separated by one year, inspired from MIDAS and then removes repeating yearly signal
If the time series has less than three years of data, then the time series is kept untouched.</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.frame">
<code class="sig-name descname">frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frame</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a time series according to an Euler pole
Returns a new Gts instance</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.make_model">
<code class="sig-name descname">make_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">option</span><span class="o">=</span><span class="default_value">'detrend'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'L2'</span></em>, <em class="sig-param"><span class="n">loutlier</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.make_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate linear model parameters using least squares
input: data: Gts format
option are: ‘detrend’/’detrend_annual’/’detrend_seasonal’
output: new Gts object: time series is now the residuals wrt to the model and its associated values (vel, annual, semi-annual etc)</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.mmodel">
<code class="sig-name descname">mmodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.mmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a modeled time series from the parameters read in self</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_pole">
<code class="sig-name descname">remove_pole</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pole</span></em>, <em class="sig-param"><span class="n">pole_type</span><span class="o">=</span><span class="default_value">'euler'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_pole" title="Permalink to this definition">¶</a></dt>
<dd><p>remove velocity predicted by an Euler pole or a rotation rate vector from a time series
pole is a 1D array with 3 values
requires self.lon &amp; self.lat attributes to have been filled before
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.add_vel_sigma">
<code class="sig-name descname">add_vel_sigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">b_fn</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.add_vel_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates realistic sigma on velocity components assuming white &amp;
flicker using eq (19) &amp; (23) from Williams (J. of Geodesy, 2003)
b_fn is the value for flicker noise, taken as 4 mm/yr^1/4
model can be detrend, detrend_annual, detrend_seasonal
if in_place = True then replace the current time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.trajectory">
<code class="sig-name descname">trajectory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_type</span></em>, <em class="sig-param"><span class="n">offset_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">eq_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">H_fix</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">H_constraints</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">H_bounds</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the parameters of a (non-linear) trajectory model for a Geodetic Time Series.
The trajectory model is:</p>
<p>y(t) =</p>
<p>trend : trend_cst + trend * ( t - t0 ) +</p>
<p>annual: a_annual * cos( 2*pi + phi_annual ) +</p>
<p>semi-annual: a_semi_annual * cos( 2*pi + phi_semi_annual ) +</p>
<p>offset : Heaviside( t - t_offset_i ) * offset_i +</p>
<p>post-seismic_deformation as decaying log (psd_log):   psd_eq_i * np.log( 1 + Heaviside( t - eq_i )/tau_i )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_type</strong> – string made of the key-word the parameters to be estimated.</p>
</dd>
</dl>
<p>Key-word parameters are</p>
<p>‘trend’,’annual’,’semi-annual’,’seasonal’,’offset’,’psd_log’.</p>
<p>‘trend-seasonal-offset-psd_log’ will do the full trajectory model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset_dates</strong> – a list of offset_dates in decimal year</p></li>
<li><p><strong>eq_dates</strong> – a list of earthquake dates for which post-seismic deformation (psd_log) will be estimated</p></li>
<li><p><strong>H_fix</strong> – a dictionary including the name of the parameter to be hold fixed and the value.</p></li>
</ul>
</dd>
</dl>
<p>For instance to impose the co-seismic offset (North-East-Up) and relaxation time of 100 days for the
first earthquake use:</p>
<p>H_fix = { ‘psd_log_offset_00’:[10., 15., 0.] , ‘psd_log_tau_00’:[100., 100., 100.]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>H_constraints</strong> – a dictionary including the name of the parameter to be constrained.</p>
</dd>
</dl>
<p>For instance to impose a 50 days constraints around 500 days
on the relaxation time of the second earthquake for all NEU components use: H_fix = { ‘psd_log_tau_01’:[[500.,50],
[500.,50] , [500.,50]]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>H_bounds</strong> – a dictionary including the bounds.</p>
</dd>
</dl>
<p>For instance to impose a relaxation time for the third earthquake to be in the range
of 2 to 3 years, for all NEU components use: H_bounds = { ‘psd_log_tau_02’:[[2*365.,3*365.], [[2*365.,3*365.] ,
[[2*365.,3*365.]]}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> – string , component for which the trajectory model will be estimated.</p></li>
<li><p><strong>verbose</strong> – verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>Unlike most pyacs.gts functions, trajectory returns 4 elements: the results as a dictionary, the model Gts,</p>
</dd>
</dl>
<p>the residual Gts and a Gts with model predictions at every day.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gts-filter-methods">
<h2>Gts filter methods<a class="headerlink" href="#gts-filter-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id2">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.el1_trend">
<code class="sig-name descname">el1_trend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lam</span></em>, <em class="sig-param"><span class="n">rho</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">return_offset</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">return_periodic</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.el1_trend" title="Permalink to this definition">¶</a></dt>
<dd><p>extensive l1 trend filtering</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam</strong> – weight of regularization of filtered data</p></li>
<li><p><strong>rho</strong> – weight of regularization of offsets</p></li>
<li><p><strong>period</strong> – tuple, periods to be estimated (1.,0.5) will estimate annual and semi-annual terms</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>return_offset</strong> – if True also return offset time serie</p></li>
<li><p><strong>return_periodic</strong> – if True also return periodic time serie</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
<li><p><strong>component</strong> – string. Default ‘NEU’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.l1_trend">
<code class="sig-name descname">l1_trend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vlambda</span></em>, <em class="sig-param"><span class="n">gap</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.l1_trend" title="Permalink to this definition">¶</a></dt>
<dd><p>return a piecewise linear filtered Gts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vlambda</strong> – weight of regularization</p></li>
<li><p><strong>gap</strong> – gap in days to split the time series before applying the filter.default is 10.</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
<li><p><strong>component</strong> – string. Default ‘NEU’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>if there are less than 4 points in a segment, return an L1 estimated trend</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.minimum_component">
<code class="sig-name descname">minimum_component</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mask_period</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">fcut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Q</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.minimum_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum component filtering for Gts.
Minimum component filtering is useful for determining the background
component of a signal in the presence of spikes
:param mask_periods: periods (list or list of lists) which should be ignored for smoothing
:param p: integer (optional). polynomial degree to be used for the fit (default = 1)
:param fcut: float (optional). the cutoff frequency for the low-pass filter.  Default value is f_nyq / sqrt(N)
:param Q: float (optional). the strength of the low-pass filter.  Larger Q means a steeper cutoff. default value is 0.1 * fcut
:param in_place: if True then replace the current time series
:param verbose: boolean, verbose mode
:return: the filtered time series
:note:
This code follows the procedure explained in the book
“Practical Statistics for Astronomers” by Wall &amp; Jenkins book, as
well as in Wall, J, A&amp;A 122:371, 1997</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.savitzky_golay">
<code class="sig-name descname">savitzky_golay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">window_length</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">polyorder</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">deriv</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">delta</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'interp'</span></em>, <em class="sig-param"><span class="n">cval</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.savitzky_golay" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a filtered time series using scipy.signal.savgol_filter</p>
<p>See documentation for the filter parameters.
<a class="reference external" href="http://https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html#scipy.signal.savgol_filter">http://https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html#scipy.signal.savgol_filter</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.smooth">
<code class="sig-name descname">smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth a time series</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.spline">
<code class="sig-name descname">spline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smoothing</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">degree</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">date</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.spline" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smoothing</strong> – Positive smoothing factor used to choose the number of knots. Number of knots will be increased</p>
</dd>
</dl>
<dl class="simple">
<dt>until the smoothing condition is satisfied:</dt><dd><p>sum((w[i] * (y[i]-spl(x[i])))**2, axis=0) &lt;= s</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degree</strong> – Degree of the smoothing spline. Must be &lt;= 5. Default is k=3, a cubic spline.</p></li>
<li><p><strong>date</strong> – 1D array of interpolation dates in decimal year, or ‘day’ for every day. defualt None will interpolate</p></li>
</ul>
</dd>
</dl>
<p>at data date only.
:return: new gts instance</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.vondrak">
<code class="sig-name descname">vondrak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fc</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NEU'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.vondrak" title="Permalink to this definition">¶</a></dt>
<dd><p>returned a filtered Gts using a Vondrak filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> – cutoff frequence in cycle per year</p></li>
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.wiener">
<code class="sig-name descname">wiener</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">my_size</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">noise</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.wiener" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a filtered time series using scipy.signal.wiener</p>
<p>See documentation for the filter parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_place</strong> – if True then replace the current time series</p></li>
<li><p><strong>verbose</strong> – boolean, verbose mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filtered time series</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gts-outliers-methods">
<h2>Gts outliers methods<a class="headerlink" href="#gts-outliers-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id3">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.remove_outliers">
<code class="sig-name descname">remove_outliers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.remove_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>removes outliers provided in self.outliers
return a new Gts without the outliers
if in_place = True then self has the outliers removed as well (in _place)</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_sliding_window">
<code class="sig-name descname">find_outliers_sliding_window</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NE'</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">automatic</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_sliding_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Find outliers using sliding windows</p>
</dd></dl>

<dl class="py method">
<dt id="pyacs.gts.Gts.Gts.find_outliers_vondrak">
<code class="sig-name descname">find_outliers_vondrak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">fc</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">in_place</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">excluded_periods</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">'NE'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.find_outliers_vondrak" title="Permalink to this definition">¶</a></dt>
<dd><p>Find outliers using a Vondrak filter</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gts-plot-methods">
<h2>Gts plot methods<a class="headerlink" href="#gts-plot-methods" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id4">
<em class="property">class </em><code class="sig-prename descclassname">pyacs.gts.Gts.</code><code class="sig-name descname">Gts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lon</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_neu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_corr_xyz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets_dates</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">offsets_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outliers</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">semi_annual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">velocity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ifile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyacs/gts/Gts.html#Gts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="pyacs.gts.Gts.Gts.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loffset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">loutliers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">date</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">yaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_yaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yupaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xticks_minor_locator</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">lcomponent</span><span class="o">=</span><span class="default_value">['N', 'E', 'U']</span></em>, <em class="sig-param"><span class="n">error_scale</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">lperiod</span><span class="o">=</span><span class="default_value">[[]]</span></em>, <em class="sig-param"><span class="n">lvline</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">save_dir_plots</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">'mm'</span></em>, <em class="sig-param"><span class="n">date_unit</span><span class="o">=</span><span class="default_value">'cal'</span></em>, <em class="sig-param"><span class="n">date_ref</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">superimposed</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lcolor</span><span class="o">=</span><span class="default_value">['r', 'g', 'c', 'm', 'y', 'k', 'b']</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">legend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">set_zero_at_date</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">grid</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">xlabel_fmt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyacs.gts.Gts.Gts.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a plot of a North-East-Up time series and related info (offsets, outliers) using Matplotlib</p>
<p>Coordinates of the time series are assumed to be in meters
default plots units will be mm; Use unit=’m’ to get meters instead</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> – string to be added to the site name as a plot title</p></li>
<li><p><strong>loffset</strong> – boolean
print a dash vertical line at offset dates</p></li>
<li><p><strong>loutliers</strong> – boolean
print outliers</p></li>
<li><p><strong>verbose</strong> – boolean
verbose mode</p></li>
<li><p><strong>date</strong> – [sdate,edate]
start and end date for plots
sdate and edate in decimal years if date_unit is either ‘decyear’ or ‘cal’, or in days if date_unit is ‘days’</p></li>
<li><p><strong>yaxis</strong> – [min_y,max_y]
min and max value for the yaxis
if not provided automatically adjusted</p></li>
<li><p><strong>yupaxis</strong> – same as yaxis but applies to the up component only</p></li>
<li><p><strong>xticks_minor_locator</strong> – where xticks_minor_locator will be placed. Float when date_unit is ‘decyear’ or ‘days’, a string ‘%Y’,’%m’,’%d’ is date_unit is ‘cal’.</p></li>
<li><p><strong>lcomponent</strong> – list of components to be plotted (default =[‘N’,’E’,’U’])</p></li>
<li><p><strong>error_scale</strong> – scaling factor for error bars (default = 1.0, 0 means no error bar)</p></li>
<li><p><strong>lperiod</strong> – list of periods to be drawn in background (color=light salmon)</p></li>
<li><p><strong>lvline</strong> – list of dates where vertical lines will be drawn in background (color=green)</p></li>
<li><p><strong>save_dir_plots</strong> – directory used for saving the plots</p></li>
<li><p><strong>save</strong> – name, save the plot into name, if simply True an automatic name is given</p></li>
<li><p><strong>show</strong> – boolean, is True show the plot</p></li>
<li><p><strong>unit</strong> – ‘m’,’cm’,’mm’, default=’mm’</p></li>
<li><p><strong>date_unit</strong> – ‘decyear’ or ‘cal’ or ‘days’, default=’decyear’</p></li>
<li><p><strong>date_ref</strong> – reference date, default=0.0</p></li>
<li><p><strong>center</strong> – boolean, if True the y_axis is centered around the mean value for the plotted period</p></li>
<li><p><strong>superimposed</strong> – if a gts is provided, it is superimposed to the master, default=None</p></li>
<li><p><strong>lcolor</strong> – color list used for the superimposed time series, default=[‘r’,’g’,’c’,’m’,’y’,’k’,’b’]</p></li>
<li><p><strong>label</strong> – label for superimposed time series to be displayed in legend, default=None</p></li>
<li><p><strong>legend</strong> – boolean. Set true to display label for superimposed time series, default=False</p></li>
<li><p><strong>set_zero_at_date</strong> – date at which the master and superimposed gts will be equal (default=None). date can also be a list with [date,offset_north,offset_east,offset_up]</p></li>
<li><p><strong>plot_size</strong> – plot size as a tuple. Default, best guess.</p></li>
<li><p><strong>grid</strong> – boolean</p></li>
<li><p><strong>info</strong> – title to appear in time series subplots</p></li>
<li><p><strong>**kwargs</strong> – <p>any argument to be passed to  matplotlib.pyplot.errorbar</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>The list of kwargs are:</p>
</dd>
</dl>
<p>{  ‘linewidth’ : 0,       ‘marker’ : marker_main_symbol ,       ‘markersize’ : marker_main_size,        ‘markerfacecolor’ : marker_main_color,       ‘markeredgecolor’ : marker_main_color,       ‘markeredgewidth’ : marker_main_colorlw,       ‘ecolor’ : error_bar_color,       ‘elinewidth’ : error_bar_linewidth,       ‘capsize’ : error_bar_capsize }</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Jean-Mathieu Nocquet IRD.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>